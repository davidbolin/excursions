\name{continuous}
\alias{continuous}
%- Also NEED an '\alias' for EACH other topic documented here.
\title{
  Calculate continuous domain excursion and credible contour sets
}
\description{
%%  ~~ A concise (1-5 lines) description of what the function does. ~~
}
\usage{
continuous(ex, geometry, alpha,
           method = c("log", "logit", "linear", "step"),
           output = c("sp", "inla"))
}
%- maybe also 'usage' for other objects documented here.
\arguments{
  \item{ex}{
    An \code{excurobj} object generated by a call to
    \code{\link{excursions}} or \code{\link{contourmap}}.
}
\item{geometry}{
  Specification of the lattice or triangulation geometry of the input.
One of
\code{list(x, y)}, \code{list(loc, dims)}, \code{inla.mesh.lattice}, or
\code{inla.mesh}, where \code{x} and \code{y} are vectors, \code{loc} is
a two-column matrix of coordinates, and \code{dims} is the lattice size
vector.  The first three versions are all treated
topologically as lattices, and the lattice boxes are assumed convex.
}
\item{alpha}{
  The target error probability.  A warning is given if it is detected
  that the information \code{ex} isn't sufficient for the given
  \code{alpha}.  Defaults to the value used when calculating \code{ex}
}
\item{method}{
  The spatial probability interpolation transformation method to use.
  One of \code{log}, \code{logit}, \code{linear}, or
  \code{step}.  For \code{log} and \code{logit}, the probabilities are
  interpolated linearly in the transformed scale. For \code{step}, a
  conservative step function is used.
}
\item{output}{
  Specifies what type of object should be generated. \code{sp} gives a
  \code{SpatialPolygons} object, and \code{inla} gives a
  \code{inla.mesh.segment} object.
}
}
\details{
  
}
\value{
  A \code{SpatialPolygons} or \code{inla.mesh.segment} object.

  The subsets are tagged, so that credible regions are tagged \code{"-1"}, and
  regions between levels are tagged \code{as.character(0:nlevels)}.
}
%%\references{
%% ~put references to the literature/web site here ~
%%}
\author{
Finn Lindgren
}
%%\note{
%%  ~~further notes~~
%%}

%% ~Make other sections like Warning with \section{Warning }{....} ~

%%\seealso{
%% ~~objects to See Also as \code{\link{help}}, ~~~
%%}
\examples{
\dontrun{
if (require(INLA)) {
  ## Generate a mesh and spde model
  mesh <- inla.mesh.create(lattice=inla.mesh.lattice(x=1:30, y=1:20),
                           refine=FALSE, extend=FALSE)
  spde <- inla.spde2.matern(mesh)
  Q <- inla.spde.precision(spde, theta=c(0, log(sqrt(8)/5)))

  ## Generate an artificial sample
  x <- inla.qsample(1, Q)[,1]
  sd.obs <- 0.5
  y <- x + rnorm(length(x), sd=sd.obs)

  ## Calculate posterior
  Q.post <- Q + Diagonal(length(x), 1/sd.obs^2)
  mu.post <- inla.qsolve(Q.post, as.matrix(y/sd.obs^2))

  ## Calculate one-sided sets for the zero crossing
  ex <- excursions(mu=mu.post, Q=Q.post, u=0, type=">",
                   alpha=0.1, F.limit=1)
  con <- continuous(ex, mesh)

  ## Plot result
  plot(con$M, col=seq_along(row.names(con$M)))

  ## Calculate contour map for some level crossing
  ex <- contourmap(mu=mu.post, Q=Q.post, levels=c(-1,0,1),
                   alpha=0.1, F.limit=1)
  con <- continuous(ex, mesh)

  ## Plot result
  plot(con$M, col=seq_along(row.names(con$M)))
}
}
}
% Add one or more standard keywords, see file 'KEYWORDS' in the
% R documentation directory.
%%\keyword{ ~kwd1 }
%%\keyword{ ~kwd2 }% __ONLY ONE__ keyword per line
